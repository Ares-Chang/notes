(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{209:function(t,s,a){t.exports=a.p+"assets/img/image-20200208222036924.8adbd156.png"},210:function(t,s,a){t.exports=a.p+"assets/img/image-20200208222202467.fe87397b.png"},211:function(t,s,a){t.exports=a.p+"assets/img/image-20200208222252745.af2b5751.png"},212:function(t,s,a){t.exports=a.p+"assets/img/image-20200208223029848.23251940.png"},213:function(t,s,a){t.exports=a.p+"assets/img/image-20200208223154720.eafd6c62.png"},214:function(t,s,a){t.exports=a.p+"assets/img/image-20200208223316794.d055a24f.png"},215:function(t,s,a){t.exports=a.p+"assets/img/image-20200208223358424.2adde22e.png"},216:function(t,s,a){t.exports=a.p+"assets/img/image-20200208223455169.246e9121.png"},217:function(t,s,a){t.exports=a.p+"assets/img/image-20200208224538226.3dd69c12.png"},218:function(t,s,a){t.exports=a.p+"assets/img/image-20200208224724799.8e0c7a2f.png"},219:function(t,s,a){t.exports=a.p+"assets/img/image-20200208232052118.c78aba84.png"},220:function(t,s,a){t.exports=a.p+"assets/img/image-20200208232225817.1e6d4649.png"},262:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"github-actions-自动部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#github-actions-自动部署"}},[t._v("#")]),t._v(" GitHub Actions 自动部署")]),t._v(" "),e("p",[t._v("GitHub Actions 由 GitHub 官方推出的工作流工具。典型的应用场景应该是 CI/CD，类似 Travis 的用法。")]),t._v(" "),e("p",[t._v("我的的项目，每次需要手动推送到 GitHub Pages 实在是太麻烦，我们使用 GitHub Actions 就可以自动起来了。")]),t._v(" "),e("h2",{attrs:{id:"一、配置域名"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、配置域名"}},[t._v("#")]),t._v(" 一、配置域名")]),t._v(" "),e("p",[t._v("如果推送自己的域名，按以下操作，如果没有域名，直接从二开始即可")]),t._v(" "),e("p",[t._v("域名解析记录中添加一个 CNAME 到 "),e("code",[t._v("<user>.github.io")]),t._v("。")]),t._v(" "),e("p",[e("img",{attrs:{src:a(209),alt:"image-20200208222036924"}})]),t._v(" "),e("p",[e("img",{attrs:{src:a(210),alt:"image-20200208222202467"}})]),t._v(" "),e("p",[e("img",{attrs:{src:a(211),alt:"image-20200208222252745"}})]),t._v(" "),e("blockquote",[e("p",[t._v("记录类型：CNAME")]),t._v(" "),e("p",[t._v("主机记录：")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("@")]),t._v(": 访问地址："),e("code",[t._v("areschang.top")])]),t._v(" "),e("li",[e("code",[t._v("www")]),t._v(" 访问地址："),e("code",[t._v("www.areschang.top")])]),t._v(" "),e("li",[e("code",[t._v("demo")]),t._v(" 访问地址： "),e("code",[t._v("demo.areschang.top")])])]),t._v(" "),e("p",[t._v("解析线路：默认")]),t._v(" "),e("p",[t._v("记录值："),e("code",[t._v("你的GitHub用户名.github.io")])]),t._v(" "),e("p",[t._v("TTL: 10分钟，默认的")])]),t._v(" "),e("p",[t._v("然后在项目的 "),e("code",[t._v("public")]),t._v(" 目录中添加一个文件 "),e("code",[t._v("CNAME")]),t._v(" 写入你的自定义域名")]),t._v(" "),e("p",[t._v("例如：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("demo.areschang.top\n")])])]),e("h2",{attrs:{id:"二、生成-github-token"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、生成-github-token"}},[t._v("#")]),t._v(" 二、生成 GitHub Token")]),t._v(" "),e("p",[t._v("点击 Settings")]),t._v(" "),e("p",[e("img",{attrs:{src:a(212),alt:"image-20200208223029848"}})]),t._v(" "),e("p",[t._v("点击 Developer settings")]),t._v(" "),e("p",[e("img",{attrs:{src:a(213),alt:"image-20200208223154720"}})]),t._v(" "),e("p",[t._v("点击 Personal access tokens 生成个人令牌")]),t._v(" "),e("p",[e("img",{attrs:{src:a(214),alt:"image-20200208223316794"}})]),t._v(" "),e("p",[t._v("自己取个名字，给予访问权限")]),t._v(" "),e("p",[e("img",{attrs:{src:a(215),alt:"image-20200208223358424"}})]),t._v(" "),e("p",[t._v("点击确定生成个人令牌")]),t._v(" "),e("p",[e("img",{attrs:{src:a(216),alt:"image-20200208223455169"}})]),t._v(" "),e("blockquote",[e("p",[t._v("注意：这个令牌自己保存好，只会出现一次，如果忘记只能再次重新生成")])]),t._v(" "),e("h2",{attrs:{id:"三、将-token-配置到项目的-secrets-中"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、将-token-配置到项目的-secrets-中"}},[t._v("#")]),t._v(" 三、将 token 配置到项目的 secrets 中")]),t._v(" "),e("p",[e("img",{attrs:{src:a(217),alt:"image-20200208224538226"}})]),t._v(" "),e("blockquote",[e("p",[t._v("Name：最好和我的一致，如果你修改了则下面的脚本内容也要修改。")]),t._v(" "),e("p",[t._v("Value：填写上一步生成的那个 token。")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(218),alt:"image-20200208224724799"}})]),t._v(" "),e("p",[t._v("如图，添加成功了")]),t._v(" "),e("h2",{attrs:{id:"四、配置-github-actions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四、配置-github-actions"}},[t._v("#")]),t._v(" 四、配置 GitHub Actions")]),t._v(" "),e("p",[t._v("在项目中创建 "),e("code",[t._v(".github/workflows/main.yml")]),t._v(" 并写入下面的配置内容。")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" build and deploy\n\n# 当 master 分支 push 代码的时候触发 workflow\non"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  push"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    branches"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" master\n\njobs"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  build"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("deploy"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    runs"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("on"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ubuntu"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("latest\n    steps"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    # 下载仓库代码\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" uses"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" actions"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("checkout@v2\n    \n    # 缓存依赖\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Cache dependencies\n      uses"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" actions"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("cache@v1\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("npm\n        key"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" runner"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("os "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("node"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hashFiles")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'**/package-lock.json'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        restore"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("keys"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n          $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" runner"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("os "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("node"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\n    \n    # 安装依赖\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" run"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" npm ci\n    \n    # 打包构建\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" run"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" npm run build\n    \n    # 发布到 GitHub Pages\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Deploy\n      uses"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" peaceiris"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("actions"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("gh"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("pages@v2\n      env"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果刚刚 name 修改了，这里也要修改为你自己设定的 name")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PERSONAL_TOKEN")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ACCESS_TOKEN")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PUBLISH_BRANCH")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" gh"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("pages\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PUBLISH_DIR")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dist\n\n")])])]),e("p",[t._v("部署需要使用到 npm 安装依赖产生的 package-lock.json 文件，所以需要使用 npm 来安装依赖")]),t._v(" "),e("h2",{attrs:{id:"五、推送源代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五、推送源代码"}},[t._v("#")]),t._v(" 五、推送源代码")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test: GtiHub Pages 自动部署测试'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push\n")])])]),e("h2",{attrs:{id:"六、查看部署状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#六、查看部署状态"}},[t._v("#")]),t._v(" 六、查看部署状态")]),t._v(" "),e("p",[e("img",{attrs:{src:a(219),alt:"image-20200208232052118"}})]),t._v(" "),e("blockquote",[e("p",[t._v("当所有的任务都完成变为绿色的对勾之后，就表示本次自动部署成功了。")]),t._v(" "),e("p",[t._v("当有新的源码 push 推送过来，会再次触发自动部署。")]),t._v(" "),e("p",[t._v("如果自动部署失败，会有红色的 ×，它还会给你发一封邮件告诉你部署失败了。")])]),t._v(" "),e("h2",{attrs:{id:"七、访问网站"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#七、访问网站"}},[t._v("#")]),t._v(" 七、访问网站")]),t._v(" "),e("p",[t._v("部署成功以后，进入 settings 中查看 GitHub Pages 服务是否正常。")]),t._v(" "),e("p",[e("img",{attrs:{src:a(220),alt:"image-20200208232225817"}})]),t._v(" "),e("p",[t._v("服务正常即可在浏览器中访问你的网站。")])])}),[],!1,null,null,null);s.default=n.exports}}]);